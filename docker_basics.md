docker基礎からのコンテナ構築

# 第3章 5分でWebサーバーを起動する
- この章の操作(DockerでApacheを起動する)のまとめ
1. Docker Hubでイメージを探す
2. `docker run`で実行する
  - 指定するオプションなどは、ドキュメントに書かれているので、それを参考にする。
  - `docker run`すれば、それだけでコンテナが起動する。
3. 停止と再開
  - `docker stop <CONTAINER ID or NAME>`で停止、`docker start`で再開。
  - コンテナの状態は`docker ps`で確認できる（起動中のもののみ）停止中のものも含めて確認するときは、`docker ps -a`とする。
4. ログの確認
  - `docker logs`でログの確認が可能
5. 破棄
  - コンテナを停止しても、コンテナは破棄されず、ディスクスペースを消費する。
  - 完全に削除するには、`docker rm`コマンドを使う。
6. イメージの破棄
  - コンテナを破棄しても、その元となったDockerイメージは残ったまま。
  - 保有しているDockerイメージは`docker image ls`コマンドで確認できる。
  - 使わなくなったイメージは、`docker image rm`コマンドを使って削除する。

# 第4章 Dockerの基本操作
- docker run は「docker pull」「docker create」「docker start」の3つのコマンドをまとめて実行する、利便性を重視したコマンド

### イメージ取得
```
docker pull <イメージ名またはイメージID>(:<タグ>)
```
- タグ名を省略したときは、最新版を意味する「latest」が指定されたものとみなされる。

### コンテナの作成
```
docker create オプション イメージ名またはイメージID 実行したいコマンド
```
- 代表的なオプション
  - --name : コンテナの名前をつける
  - -p : ポート番号をマッピングする
  ```
  -p ホストのポート番号:コンテナのポート番号
  ```
  - -v : マウント設定
  ```
  -v ホストのディレクトリ:コンテナのディレクトリ
  ```

### Dockerコンテナの開始と停止
- docker startを実行すると、既定のコマンドか、docker createの引数で明示的に指定したコマンドが実行される。そのコマンドの実行が完了すると、Dockerコンテナは停止する。
- httpdコンテナの既定のコマンドは終了することがないように作られているので、実行しっぱなしの状態でいられる。

## デタッチとアタッチ
- 端末と切り離しで実行する状態をデタッチ（detach）、端末と接続した状態で実行することをアタッチ（attach）という。
- デタッチの状態とアタッチの状態は、実行中に切り替えることができる。

### -dit
- コンテナをバックグラウンドで実行するときは「-d」、キーボード操作するなら「-it」をつける

### docker exec
- 実行中のコンテナ内を操作したいときはdocker execで/bin/bashなどのシェルを起動する。

# 第5章 コンテナ内のファイルと永続化
- コンテナを破棄すると、コンテナ内のデータも失われる。
- コンテナ内のデータを永続化したい場合はマウントする。
- バインドマウントとボリュームマウントがある。
  - バインドマウント： Dockerホストのディレクトリをマウントする方法
  - ボリュームマウント：Docker Engineで管理されている領域にマウントする方法
- バックアップ　（未読）

# 第6章 コンテナのネットワーク
- Dockerホスト同士はIPアドレスで通信できる
  - 既定のbridgeネットワークでは、Dockerホスト同士はIPアドレスで接続できる。IPアドレスは、docker network inspectやdocker container inspectで確認できる。
- コンテナ名で通信したいときはDockerネットワークを作る。
- コンテナ間の通信では-pオプションは関係ない。
- hostネットワークとnoneネットワークというのがあるが、あまり使われない。

# 第7章 複数コンテナをまとめて起動するDocker Compose
- docker-compose.ymlに起動したコンテナ、ネットワーク、ボリュームの情報を記述する。
- docker-compose upでまとめて起動。必要なネットワーク、ボリュームも作られる。
- docker-compose downでまとめて停止・破棄する。ボリュームは残る。
- コンテナの名前はDocker Composeに基づくものになる、

# 第8章 イメージを自作する
