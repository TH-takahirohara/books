マスタリングTCP/IP 入門編 第5版

### 1.8.2 アドレスの階層性
- MACアドレスとIPアドレス　両方唯一性はあるが、階層性はIPアドレスのみ
- MACアドレス：　転送表（フォワーディングテーブル）
- IPアドレス：　経路制御表（ルーティングテーブル）

## 1.9 ネットワークの構成要素
- ネットワークインタフェース：　コンピュータをネットワークに接続するための装置
- リピーター：　ネットワークを物理層で延長する装置
- ブリッジ／レイヤ2スイッチ：　ネットワークをデータリンク層で延長する装置
- ルーター／レイヤ3スイッチ：　ネットワーク層によってパケットを転送する装置
- レイヤ4-7スイッチ：　トランスポート層より上の情報でトラフィックを処理する装置
- ゲートウェイ：　プロトコルの変換をする装置

### 1.9.1 通信媒体とデータリンク

### 1.9.2 ネットワークインタフェース

### 1.9.3 リピーター
- ネットワークを物理層で延長する装置
- 減衰して変形した信号の波形を増幅・整形して流す

### 1.9.4 ブリッジ／レイヤ2スイッチ
- データリンク層でネットワーク同士を接続する装置。MACアドレスで処理を行う。
- ブリッジは、データリンクのフレームのFCSと呼ばれるフィールドをチェックして、壊れたフレームを他のセグメントへ送信しないようにする働きがある。
- ラーニングブリッジ
- イーサネットなどで利用されるスイッチングハブは、現在ではほとんどがこのブリッジの一種

### 1.9.5 ルーター／レイヤ3スイッチ
- ネットワークとネットワークを接続して、パケットを中継する装置。ネットワーク層のアドレス（TCP/IPではIPアドレス）で処理を行う。

### 1.9.6 レイヤ4-7スイッチ
- トランスポート層からアプリケー ション層の情報に基づいて配送処理を行う
- ロードバランサーは、複数のサーバーに負荷を分散するレイヤ4-7スイッチの一種

### 1.9.7 ゲートウェイ
- トランスポート層以上の情報を見てパケットを処理するが、それだけでなくデータを変換する役割がある。特に、異なるプロトコルの変換を行うためによく利用される。
- ウェブにおいて、トラフィックの軽減やセキュリティを意図して代理サーバー（プロキシサーバー）を設定する場合がある。この代理サーバーもゲートウェイの一種である。

## 1.10 現在のネットワークの姿
### 1.10.1 実際のネットワークの構成
- コア（バックボーン）
- エッジ
- アクセス（アグリゲーション）

### 1.10.2 インターネット接続サービスを利用した通信

### 1.10.3 携帯電話による通信
- 基地局が「アクセス」に相当する。

### 1.10.4 情報発信者側にとってのネットワーク
- データセンター

#### 仮想化とクラウド
- 仮想化技術：　サーバーなどを、ソフトウェアを使って論理的に、必要な時に必要な量を提供できるようにする仕組み
- 仮想化技術を利用し、利用者にとって必要な資源を自動的に提供する仕組みをクラウドと呼ぶ。
- また、仮想化されたシステム全体を必要に応じて自動的に制御する仕組みをオーケストレーションと呼ぶ。

# 第2章 TCP/IP 基礎知識
## 2.1 TCP/IP登場の背景とその歴史
### 2.1.1 軍事技術の応用から
- 軍事的な理由から、障害に強い分散型のネットワークと、それを実現するためのパケット通信の必要性が唱えられた。
- また、パケット通信を利用すれば、複数ユーザーで1つの回線を共有できるというコスト面のメリットも注目された。

### 2.1.2 ARPANETの誕生
- 1969年、パケット交換技術の実用性試験のためにARPANETと呼ばれるネットワークが構築された。この実験により、パケットによるデータ通信手法が実用に耐えることが証明された。

### 2.1.3 TCP/IPの誕生
- 1970年代前半に、ARPANET内の研究グループによって、TCP/IPが開発された。

### 2.1.4 UNIXの普及とインターネットの拡大
- 1980年前後の大学や研究所などでは、コンピュータのOSとしてBSD UNIXが広く利用されていた。このOSの内部にTCP/IPが実装されていた。
- 1980年代に、LANの発達とUNIXワークステーションの普及が急速に進むと同時に、TCP/IPによるネットワークの構築も盛んに行われるようになった。
- インターネットは、終端ノード間のUNIXマシン同士をつなげる形で普及していった。

### 2.1.5 商用インターネットサービスの開始
- 90年代になると、企業や一般家庭に対してインターネットへの接続を提供するサービスが普及し、広く利用されるようになった。このようなサービスを提供する会社をISPと呼ぶ。
- TCP/IPは、研究ネットワークとしてインターネットで長い間運用されてきたことで、商用サービスにも耐えうる成熟したプロトコルになっていた。

## 2.2 TCP/IPの標準化
- TCP/IP の標準化には、ほかのプロトコルの標準化には見られない特徴がある。

### 2.2.1 TCP/IPという語は何を指す
- 多くの場合、TCP/IPという言葉は、IPを利用したり、IPで通信したりするときに必要となる多くのプロトコル群の総称として使われる。

### 2.2.2 TCP/IP標準化の精神
- TCP/IPのプロトコルの標準化は、ほかの標準化と比べると2つの点が大きく異なる。
  1. オープンであること
  2. 標準化するプロトコルが実際に使えるプロトコルであるかどうかを重視すること（動かすことを重視して仕様が決められるのでプロトコルの実用性が高い）
- TCP/IPに比べてOSIが一般に普及しなかったのは、上記の特徴がなかったことが原因と考えられている。

### 2.2.3 TCP/IPの仕様書 RFC
- IETFで議論され、標準化しようとするプロトコルは、RFCと呼ばれるドキュメントになり、インターネット上で公開される。RFCは仕様書だけでなく、プロトコルの実装や運用に関する有用な情報やプロトコルの実験に関する情報も含まれる。
- STD

### 2.2.4 TCP/IPプロトコルの標準化の流れ
- 標準化の流れは、大まかに次の段階を経る事になる。
  - インターネットドラフト、提案標準、ドラフト標準、標準
- TCP/IPの世界では、「標準」になったプロトコルにはすでに広い運用実績があるため、非常に実用性が高い技術となる。

### 2.2.5 RFCの入手方法

## 2.3 インターネットの基礎知識
### 2.3.1 インターネットとは
- 現在、インターネットというと、ARPANETから発展し、全世界を接続しているコンピュータネットワークのことを指す。

### 2.3.2 インターネットとTCP/IPの関係
- インターネットのプロトコルといえばTCP/IP。逆も然り。

### 2.3.3 インターネットの構造
- NOC: ネットワークとネットワークを接続するポイント
- IX: ネットワークの運用者（ISP等）などが異なるネットワークを対等に接続するポイント
- インターネットは、異なる組織がIXによって相互に接続された巨大なネットワークと言える。

### 2.3.4 ISPと地域ネット
- インターネットに接続するためには、ISPや地域ネットに接続を依頼することになる。

## 2.4 TCP/IPプロトコルの階層モデル
- TCP/IPプロトコルの全体像の説明

### 2.4.1 TCP/IPとOSI参照モデル
- OSI参照モデル：　「通信プロトコルに必要な機能は何か」を中心に考えてモデル化
- TCP/IPの階層モデル：　「プロトコルをコンピュータに実装するにはどのようにプログラミングしたら良いか」を中心に考えてモデル化

### 2.4.2 ハードウェア（物理層）
- イーサネットや電話回線などの物理層のこと。しかしその内容については何も決めていない（なんでも良い）

### 2.4.3 ネットワークインタフェース層（データリンク層）
- イーサネットなどのデータリンクを利用して通信をするためのインタフェースとなる階層。つまりNICを動かすための「デバイスドライバ」と考えて良い。
- NICを購入した場合、ソフトウェアとしてデバイスドライバが普通は付属される。それを利用するコンピュータのOSにインストールすることで、初めてネットワークインタフェースを利用できる環境が整う。

### 2.4.4 インターネット層（ネットワーク層）
- IPプロトコルが使われる。
- IP
- ICMP
- ARP

### 2.4.5 トランスポート層
- トランスポート層の最も重要な役割はアプリケーションプログラム間の通信を実現すること。
- TCP：　コネクション型で信頼性のあるトランスポート層のプロトコル
- UDP：　コネクションレス型で信頼性のないトランスポート層のプロトコル

### 2.4.6 アプリケーション層（セッション層以上の上位層）
- WWW(World Wide Web)
  - Webブラウザというソフトウェアを使う。ブラウザとサーバー間の通信で使われるプロトコルがHTTP。送信に使われる主なデータフォーマットがHTML。
  - WWWでは、HTTPがOSI参照モデルのアプリケーション層のプロトコル、HTMLがプレゼンテーション層のプロトコルと言える。
- 電子メール
  - SMTP
  - 電子メールで送信できるデータ形式を拡張するMIME(OSI参照モデルのプレゼンテーション層の機能)
- ファイル転送（FTP）
- 遠隔ログイン（TELNETとSSH）
- ネットワーク管理（SNMP）

## 2.5 TCP/IPの階層モデルと通信例
- TCP/IPを使うときの、アプリケーション層から物理媒体までのデータと処理の流れを見てみる。

### 2.5.1 パケットヘッダ
- パケット、フレーム、データグラム、セグメント、メッセージ
- パケットヘッダには、プロトコルの仕様が見える形で存在していると言える。

### 2.5.2 パケットの送信処理 - メール送信の例
1. アプリケーションの処理
  - 符号化, 送信タイミングの管理, 送信時にTCPにコネクション確立を指示, 確立されたらそれを利用してメールデータを送信
2. TCPモジュールの処理
  - アプリケーションの指示により、コネクションを確立したり、データを送信したりする。
3. IPモジュールの処理
  - TCPから渡されたデータにIPヘッダを付与しIPパケットを構成
  - ルーティングテーブルをもとに、次に渡すノードが接続されるネットワークインタフェースのドライバにIPパケットを渡す
  - 通信先のノードのMACアドレスが分からない場合は、ARPを利用してMACアドレスを解決
4. ネットワークインタフェース（イーサネットドライバ）の処理
  - IPから渡されたIPパケットに、イーサネットのヘッダを付与し送信処理を実行

### 2.5.3 データリンクを流れるパケットの様子
- パケットが流れる時は、先頭にイーサネットヘッダがつき、その後ろにIPヘッダが、というように続く。
- それぞれのヘッダには、少なくとも2種類の情報が入っている。それは「宛先と送信元のアドレス」と「上位層のプロトコルが何かを示す情報」である。

### 2.5.4 パケットの受信処理
- 受け取ったホストでの処理は、送信ホストの処理と全く逆になる。
5. ネットワークインタフェースの処理
6. IPモジュールの処理
7. TCPモジュールの処理
  - チェックサムを計算してヘッダやデータが壊れていないかを確認する。データを順番通りに受信しているか確認。
8. アプリケーションの処理
