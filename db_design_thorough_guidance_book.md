達人に学ぶDB設計徹底指南書

# 第1章 データベースを制する者はシステムを制す
## 1-1 システムとデータベース
- データベースを使わないシステムは、この世に存在しない。
- 本書でのデータの定義は、「ある形式（フォーマット）に揃えられた事実」である。形式は二次元表など。データベースは、こうした一定の形式に従ったデータの蓄積である。
- 一方、情報という概念は、データと文脈を合成して生まれるものである。
- システムは、ユーザーが登録したデータを引き出して情報を作り出すという一連のサイクルの中に位置付けることもできる。

## 1-2 データベースあれこれ
- 現在商用利用されているデータベースには何種類かあるが、その分類はデータを保持するフォーマットを基準にして行われている。
  - リレーショナルデータベース：　最も広く利用されている。
  - オブジェクト指向データベース
  - XMLデータベース
  - キー・バリュー型ストア（Key-Value Store: KVS）
  - 階層型データベース
- モデルが異なれば設計技法も異なる。ただし、設計技法の達成したい目的（データの整合性の保持や冗長性排除など）はモデルが変わっても同じである。
- RDBでもDBMSは複数あるが、DBMSが異なって、（基本的には）設計の方法は影響を受けない。

## 1-3 システム開発の工程と設計
- 開発の工程は以下に分解・分類できる。
  1. 要件定義：　要件（システムが満たすべき機能など）を決める工程
  2. 設計：　要件を満たすために必要なシステムを作るための設計を行う工程
  3. 開発（実装）：　設計書に従ってシステムを実際に作る工程
  4.テスト：　実装によって組み上がったシステムが、実用に耐える品質であるかを試験する工程
- 本書では設計工程に焦点を当てていく。
- システム開発の進め方（開発モデル）には大きく分けて二つの方法がある。
  - ウォーターフォールモデル
  - プロトタイピングモデル

## 1-4 設計工程とデータベース
- 本書では、データベースに保持するデータの設計（データベース設計と呼ぶ）について述べる。これが重要な理由は二つ。
  1. システムにおいて大半のデータ（少なくとも永続的に使用されるデータ）はデータベース内に保持される。そのため、普通、データ設計とはデータベース設計とほぼ同義である。
  2. データ設計がシステムの品質を最も大きく左右する。ソフトウェアというのは、言ってみれば「データの流通機構」であって、どのようなプログラムが必要になるかは、どのようなデータをどういうフォーマットで設計するかに左右される。

### DOAとPOA
- このうち特に重要なのが理由1である。近年のソフトウェア開発では、データ中心アプローチ（Data Oriented Approach:DOA）という考え方が主流となっているためである。かつて主流の考えであったプロセス中心アプローチ（POA）は現在では普通採用されることはない。
- POAはプロセス単位でデータ設計を行うことになるため、複数のプロセスで同じデータを別個に持つという冗長性が生じるなどの不都合が多い。
- DOAはPOAの欠点を克服するために登場した。その着眼のポイントは、データがあまり変化しない（永続的）という点である。データの意味や形式が先に決まっていれば、複数のプログラムで共用することも容易で、業務要件の仕様変更にも柔軟に対応できる。
- こうした理由から、システム開発においては、プログラム設計に先立ってまずデータ設計が優先されるのである。
- よって、データ設計（≒データベース設計）はシステムの品質を決める最も重要な要因と言っても過言ではない。

### 3層スキーマ
- DB設計で踏むべき具体的な段階について整理する上で重要となる概念が「スキーマ」である。DB設計においては、データベースのデータ構造やフォーマットという意味で使う。DB設計のステップは、このスキーマのレベルと密接に結びついている。スキーマは、一般的に三つのレベルに分けられる。
  1. 外部スキーマ
  2. 概念スキーマ
  3. 内部スキーマ
- この三つのスキーマに基づいてシステムを記述したモデルを、「3層スキーマモデル」と呼ぶ。

1. 外部スキーマ
  - ユーザーから見たデータベースの姿を定義するスキーマ。DBのオブジェクトとしては、ビューが相当する。
2. 概念スキーマ
  - 開発者から見たデータベースの姿を定義するスキーマ。
  - 必然的に、DB設計において重要な位置を占めることになる。
  - 概念スキーマの設計を「論理設計」とも呼ぶ。
3. 内部スキーマ
  - DBMSから見たデータベースを定義するスキーマ。
  - 論理設計との対比で「物理設計」と呼ぶ。

- 概念スキーマがいらないように見えるが、これは外部スキーマと内部スキーマの間にあることで、両者の変更が互いに影響しあわないようにするための緩衝材の役割を果たす。このようなスキーマの独立性のことを、**データ独立性**と呼ぶ。外部スキーマからの独立性を**論理的データ独立性**、内部スキーマからの独立性を**物理的データ独立性**と呼ぶ。概念スキーマはデータ独立性を保証するためにある。
- 概念の有用性がわからなかったら、「それがなかったらどうなるか」を考えてみるのが良い。
