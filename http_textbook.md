HTTPの教科書

## 2.7 持続的接続で通信料を節約
- HTTPの初期のバージョンでは、HTTPによる通信を1回行うごとにTCPによる接続と切断を行う必要があった。
- HTTP/1.1と一部のHTTP/1.0では、**持続的接続**という方法が考え出された。これは、どちらかが明示的に接続を切断しない限り、TCP接続を繋げっぱなしにしておくということ。
- これにより、TCPコネクションの接続と切断を繰り返すオーバーヘッドを減らせるので、その分Webページの表示が速くなる。
- これは、複数のリクエストを発行できる**パイプライン化**を可能にする。これにより、複数のリクエストを並行して発行できるので、1つ1つのレスポンスを待つ必要がなくなった。

## 2.8 Cookieを使った状態管理
- Cookieは、リクエストとレスポンスにCookieという情報を載せることによって、クライアントの状態を把握するための仕組み。
- Cookieは、サーバーからのレスポンスで送られたSet-Cookieというヘッダーフィールドによって、Cookieをクライアントに保存してもらうように指示を出す。次にクライアントが同じサーバーにリクエストを出す際には、クライアントが自動的に Cookieの値を入れて送信する。
- サーバーはクライアントが送ってきた Cookieを見ることで、どのクライアントからのアクセスなのかをチェックし、サーバー上の記録を確かめることで、以前の状態を知ることができる。

# 第3章 HTTPの情報はHTTPメッセージにある

## 3.1 HTTPメッセージ
- HTTPでやり取りされる情報はHTTPメッセージと呼ばれていて、リクエスト側のHTTPメッセージをリクエストメッセージ、レスポンス側をレスポンスメッセージと呼ぶ。
- HTTPメッセージを大きく分けると、メッセージヘッダーとメッセージボディから構成されて、空行が区切りになる。

## 3.2 リクエストメッセージとレスポンスメッセージの構造
- メッセージヘッダーの中身は、次のデータで構成される。
  - リクエストライン
  - ステータスライン
  - ヘッダーフィールド
    - 一般ヘッダーフィールド、リクエストヘッダーフィールド、レスポンスヘッダーフィールド、エンティティヘッダーフィールドの4種類
  - その他

## 3.3 エンコーディングで転送効率を上げる
- HTTPでデータを転送する場合、転送の際にエンコーディングを施すことで転送効率を上げることができる。
- メッセージ
- エンティティ
- コンテンツコーディング: エンティティに適用するエンコーディングのことで、エンティティの情報を保ったまま圧縮する。
- チャンク転送コーディング: エンティティを分割してから送信すること

## 3.4 複数のデータを送れるマルチパート
- マルチパート: MIMEの拡張仕様にある、複数の異なる種類のデータを格納する方式
  - MIME: メールでテキスト、画像、動画といった複数の異なるデータを扱うための仕組み
- HTTPもマルチパートに対応していて、1つのメッセージボディの中に複数のエンティティを含めて送ることができる。主に画像やテキストファイルなどのファイルアップロードの際に使われる。
- 詳細はRFC2046も参考のこと

## 3.5 一部分だけ貰えるレンジリクエスト
- 範囲を指定してリクエストを行うことを、**レンジリクエスト**と呼ぶ。
  - レジューム機能（以前ダウンロードを中断した箇所からダウンロードを再開できる）を実現する上で、エンティティの範囲を指定してDLを行う必要があり、その時などに使われる。
- レンジリクエストを行う場合、Rangeヘッダーフィールドを使って、リソースのバイトレンジを指定する。
- レンジリクエストに対するレスポンスは、ステータスコード206 Partial Contentが返される。

## 3.6 最適なコンテンツを返すコンテンツネゴシエーション
- 同じコンテンツだが、複数のページを持つWebページ（例えば、英語版と日本語版）について、クライアントに最も適したリソースを提供するための仕組みをコンテンツネゴシエーションと呼ぶ。
- コンテンツネゴシエーションでは、提供するリソースを言語や文字セット、エンコーディング方式などを基準に判断している。
